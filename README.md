# ìŠ¤ë§ˆíŠ¸íŒœ & ìŠ¤ë§ˆíŠ¸íŒœ ê´€ë¦¬ ì„œë¹„ìŠ¤

## ðŸŽ™ï¸í”„ë¡œì íŠ¸ ì†Œê°œ

-    ì§‘ì•ˆ ì–´ë””ì—ì„œë‚˜ ì‰½ê²Œ ì‹ë¬¼ì„ í‚¤ìš¸ ìˆ˜ ìžˆìœ¼ë©°, ì›¹ì„ ì´ìš©í•˜ì—¬ ëª¨ë‹ˆí„°ë§ì´ ê°€ëŠ¥í•œ ê°€ì •ìš© ë†ìž¥

## í”„ë¡œì íŠ¸ íŒŒì¼ êµ¬ì¡°
```|-- include/           # í—¤ë” íŒŒì¼ ëª¨ìŒ
|   |-- config.h       # ê° ê¸°ê¸°ì˜ í•€ ì„¤ì • ë° MQTT ì„œë²„ ì£¼ì†Œ ì •ì˜
|   |-- network.h      # ë„¤íŠ¸ì›Œí¬ ê´€ë ¨ ê¸°ëŠ¥ ì„ ì–¸
|   |-- saferanges.h   # ë²”ìœ„ ì•ˆì „ì„± ê²€ì‚¬ ê´€ë ¨ í•¨ìˆ˜ ì„ ì–¸
|   |-- sensors.h      # ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬ ê´€ë ¨ í•¨ìˆ˜ ì„ ì–¸
|
|-- src/               # ì†ŒìŠ¤ ì½”ë“œ ëª¨ìŒ
|   |-- callback.cpp   # ì½œë°± í•¨ìˆ˜ ì •ì˜
|   |-- main.cpp       # ë©”ì¸ ì‹¤í–‰ íŒŒì¼
|   |-- network.cpp    # APëª¨ë“œ ê´€ë¦¬ì™€ mqtt ì—°ê²° ê¸°ëŠ¥ êµ¬í˜„
|   |-- pub.cpp        # MQTT Publish ê¸°ëŠ¥ êµ¬í˜„
|   |-- saferanges.cpp # ì•ˆì „ ë²”ìœ„ ê³„ì‚° ë° spiffs íŒŒì¼
|   |-- sensors.cpp    # ì¸¡ì •ì„¼ì„œ ë°ì´í„° ì²˜ë¦¬ êµ¬í˜„
|   |-- sub.cpp        # MQTT Subscribe ê¸°ëŠ¥ êµ¬í˜„
|
|
|-- .env               # í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ (.gitignoreì— ì¶”ê°€ í•„ìš”)
|-- platform.ini       # PlatformIO ì„¤ì • íŒŒì¼
|-- .gitignore         # Gitì— í¬í•¨í•˜ì§€ ì•Šì„ íŒŒì¼ ëª©ë¡
|-- project.md         # í”„ë¡œì íŠ¸ ì„¤ëª… íŒŒì¼
|-- file.md             # íŒŒì¼ êµ¬ì¡° ì„¤ëª… MD```


## ðŸª„ ê¸°ìˆ  ìŠ¤íƒ

-    Device: PlatformIO(c++)
-    DB : MongoDB(NoSQL)

## â° ê°œë°œ ê¸°ê°„

-   2024.08.12-2024.09.06

## ì‚¬ìš©ëœ ìž¥ë¹„

í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©ëœ ì£¼ìš” ìž¥ë¹„ ëª©ë¡ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤

1. **DC íŒ¬ (DC Fan)**: 
   - ì˜¨ë„ ì¡°ì ˆì„ ìœ„í•´ ê³µê¸° íë¦„ì„ ì¡°ì ˆí•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. íŽ í‹°ì–´ ì†Œìžì™€ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ì˜¨ë„ë¥¼ ì œì–´í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
   
2. **DHT11 ì„¼ì„œ**: 
   - ì˜¨ë„ ë° ìŠµë„ ì¸¡ì • ì„¼ì„œë¡œ, ì‹¤ë‚´ ë˜ëŠ” ê¸°ê¸° ì£¼ë³€ì˜ í™˜ê²½ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤. ì•ˆì „ ë²”ìœ„ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì´ìƒ ìƒíƒœë¥¼ ê°ì§€í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

3. **í†µì–‘ìˆ˜ë¶„ ì¸¡ì • ì„¼ì„œ**: 
   - í† ì–‘ì˜ ìˆ˜ë¶„ ì •ë„ë¥¼ ì¸¡ì •í•˜ì—¬ ì‹ë¬¼ì˜ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤. íŠ¹ì • ìˆ˜ë¶„ ê°’ ì´í•˜ì¼ ê²½ìš° íŽŒí”„ë¥¼ ìž‘ë™ì‹œì¼œ ë¬¼ì„ ê³µê¸‰í•˜ëŠ” ìžë™í™” ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

4. **íŽŒí”„ (Pump)**: 
   - **ë‘ ê°œì˜ íŽŒí”„**ê°€ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤. 
     - ì²« ë²ˆì§¸ íŽŒí”„ëŠ” í† ì–‘ì— ë¬¼ì„ ê³µê¸‰í•˜ê¸° ìœ„í•œ ìš©ë„ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ìˆ˜ë¶„ ì¸¡ì • ì„¼ì„œì—ì„œ ë¶€ì¡± ìƒíƒœê°€ ê°ì§€ë˜ë©´ ìžë™ìœ¼ë¡œ ìž‘ë™ë©ë‹ˆë‹¤.
     - ë‘ ë²ˆì§¸ íŽŒí”„ëŠ” ë¹„ë£Œë¥¼ ê³µê¸‰í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ë¹„ë£Œê°€ í•„ìš”í•œ ì‹œì ì— ìžë™ìœ¼ë¡œ ìž‘ë™í•˜ì—¬ ì‹ë¬¼ì˜ ì„±ìž¥ì„ ë„ìš¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

5. **íŽ í‹°ì–´ ì†Œìž (Peltier Element)**: 
   - ì—´ì „ íš¨ê³¼ë¥¼ ì´ìš©í•´ ëƒ‰ê° ë° ê°€ì—´ì„ ë™ì‹œì— ìˆ˜í–‰í•  ìˆ˜ ìžˆëŠ” ì†Œìžìž…ë‹ˆë‹¤. ì˜¨ë„ ì¡°ì ˆì— ë§¤ìš° ìœ ìš©í•˜ë©°, DC íŒ¬ê³¼ í•¨ê»˜ ì„¤ì¹˜í•˜ì—¬ ì—´ì„ ë°°ì¶œí•©ë‹ˆë‹¤.

6. **12V ì¡°ëª…**: 
   - ì‹ë¬¼ ìƒìž¥ì„ ë•ê¸° ìœ„í•œ ì¡°ëª…ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ìžë™ ì¡°ëª… ì œì–´ ê¸°ëŠ¥ì„ í†µí•´ ì¼ì • ì‹œê°„ ë™ì•ˆë§Œ ì¼œì§€ë„ë¡ ì„¤ì •ë©ë‹ˆë‹¤.

7. **ê°€ìŠµê¸° ëª¨ë“ˆ (Humidifier Module)**: 
   - ì‹¤ë‚´ ìŠµë„ë¥¼ ì¡°ì ˆí•˜ì—¬ ì‹ë¬¼ì˜ ìƒìž¥ í™˜ê²½ì„ ìµœì í™”í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì œì–´ ì‹ í˜¸ë¥¼ ë°•ìœ¼ë©´ ìž‘ë™í•©ë‹ˆë‹¤. ì ì • ìŠµë„ë¥¼ ìœ ì§€í•˜ëŠ” ë° ê¸°ì—¬í•©ë‹ˆë‹¤.


### âœ¨ ì£¼ìš” ê¸°ëŠ¥

## 1. AP ëª¨ë“œ (Access Point Mode)

AP ëª¨ë“œëŠ” ë””ë°”ì´ìŠ¤ê°€ ìžì²´ì ìœ¼ë¡œ Wi-Fi ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸(AP)ë¥¼ ì„¤ì •í•˜ì—¬ ë‹¤ë¥¸ ìž¥ì¹˜ê°€ í•´ë‹¹ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°í•  ìˆ˜ ìžˆë„ë¡ í•˜ëŠ” ëª¨ë“œìž…ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìžê°€ ê¸°ê¸°ë¥¼ ë„¤íŠ¸ì›Œí¬ì— ì‰½ê²Œ ë“±ë¡í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤
- **ê¸°ê¸° ì´ˆê¸° ì„¤ì •**: ì‚¬ìš©ìžê°€ ë„¤íŠ¸ì›Œí¬ì— ê¸°ê¸°ë¥¼ ì²˜ìŒ ì—°ê²°í•  ë•Œ AP ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‰½ê²Œ ë“±ë¡í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **Wi-Fi ì„¤ì • ë³€ê²½**: ê¸°ê¸°ì˜ Wi-Fi ì„¤ì •ì„ ìž¬ì„¤ì •í•˜ê±°ë‚˜ ë³€ê²½í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤.

### íŠ¹ì§•
- **ì‚¬ìš©ìž ì§ì ‘ ë“±ë¡**: ì‚¬ìš©ìžê°€ ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ë‹¤ë¥¸ ë””ë°”ì´ìŠ¤ë¥¼ í†µí•´ ì§ì ‘ APì— ì—°ê²°í•˜ê³ , í•„ìš”í•œ ì •ë³´ë¥¼ ìž…ë ¥í•˜ì—¬ ê¸°ê¸°ë¥¼ ë„¤íŠ¸ì›Œí¬ì— ë“±ë¡í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **ë„¤íŠ¸ì›Œí¬ ë…ë¦½ì„±**: ê¸°ì¡´ Wi-Fi ë„¤íŠ¸ì›Œí¬ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ìžì²´ ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬ì„±í•´ ìž¥ì¹˜ ê°„ ì—°ê²°ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.

### êµ¬í˜„ ë°©ë²•
1. **ESP32 AP ëª¨ë“œ ì„¤ì •**: AP ëª¨ë“œ ì„¤ì •ì„ ìœ„í•´ `WiFi.softAP(ssid, password)` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ SSIDì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
2. **ê¸°ê¸° ë“±ë¡ íŽ˜ì´ì§€ ì œê³µ**: HTTP ì„œë²„ë¥¼ í†µí•´ AP ëª¨ë“œì— ì—°ê²°ëœ ê¸°ê¸°ì—ì„œ ì›¹íŽ˜ì´ì§€ë¥¼ ì—´ì–´ ë“±ë¡ ì ˆì°¨ë¥¼ ì§„í–‰í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
3. **MQTT í†µì‹  ì„¤ì •**: AP ëª¨ë“œë¥¼ í†µí•´ ë“±ë¡ëœ ê¸°ê¸°ë¥¼ MQTT ë¸Œë¡œì»¤ì— ì—°ê²°í•˜ì—¬ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ìŠµë‹ˆë‹¤.

## 2. SPIFFS íŒŒì¼ ì ìš©

SPIFFS íŒŒì¼ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìžê°€ ê¸°ê¸° ë“±ë¡ í›„ ìž…ë ¥í•œ ì•ˆì „ ë²”ìœ„ ê°’ì„ ì €ìž¥í•˜ê³ , ì´ë¥¼ í˜„ìž¬ ì„¼ì„œë¡œë¶€í„° ìˆ˜ì§‘ëœ ë°ì´í„°ì™€ ë¹„êµí•˜ì—¬ ì´ìƒ ì•Œë¦¼ì„ ì „ì†¡í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ ì•Œë¦¼ì€ MQTTë¥¼ í†µí•´ ë°±ì—”ë“œ ì„œë²„ì— ì „ë‹¬ë©ë‹ˆë‹¤.

### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤
- **ì•ˆì „ ë²”ìœ„ ì„¤ì •**: ì‚¬ìš©ìžê°€ ê¸°ê¸° ë“±ë¡ ì‹œ ìž…ë ¥í•œ ì•ˆì „ ë²”ìœ„ ê°’(ì˜ˆ: ì˜¨ë„, ìŠµë„, ì••ë ¥ ë“±)ì„ SPIFFS íŒŒì¼ ì‹œìŠ¤í…œì— ì €ìž¥í•˜ì—¬, ë‚˜ì¤‘ì— í•´ë‹¹ ê°’ê³¼ ì„¼ì„œ ë°ì´í„° ê°„ì˜ ë¹„êµë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.
- **ì´ìƒ ìƒíƒœ ê°ì§€**: ì €ìž¥ëœ ì•ˆì „ ë²”ìœ„ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ í˜„ìž¬ ì„¼ì„œì—ì„œ ì½ì–´ë“¤ì¸ ê°’ì´ ì•ˆì „ ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ê²½ìš°, ì´ë¥¼ ê°ì§€í•˜ì—¬ ë°±ì—”ë“œ ì„œë²„ì— ì•Œë¦¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.

### íŠ¹ì§•
- **ë°ì´í„° ì˜êµ¬ ì €ìž¥**: SPIFFS íŒŒì¼ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ì—¬ ê¸°ê¸° ë“±ë¡ ì‹œ ìž…ë ¥ëœ ì•ˆì „ ë²”ìœ„ ê°’ì„ ë””ë°”ì´ìŠ¤ì— ì˜êµ¬ì ìœ¼ë¡œ ì €ìž¥í•©ë‹ˆë‹¤.
- **MQTT ê¸°ë°˜ ì•Œë¦¼ ì‹œìŠ¤í…œ**: ì´ìƒ ìƒíƒœê°€ ê°ì§€ë˜ë©´ MQTTë¥¼ í†µí•´ ë°±ì—”ë“œ ì„œë²„ì— ê²½ê³  ì•Œë¦¼ì„ ë³´ëƒ…ë‹ˆë‹¤.
- **ì‹¤ì‹œê°„ ë¹„êµ**: ì„¼ì„œë¡œë¶€í„° ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ì €ìž¥ëœ ì•ˆì „ ë²”ìœ„ ê°’ê³¼ ë¹„êµí•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.

### êµ¬í˜„ ë°©ë²•
1. **SPIFFS íŒŒì¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™”**: ë””ë°”ì´ìŠ¤ê°€ ì‹œìž‘ë  ë•Œ SPIFFS íŒŒì¼ ì‹œìŠ¤í…œì„ ì´ˆê¸°í™”í•˜ì—¬ ì €ìž¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ì¤€ë¹„ë¥¼ í•©ë‹ˆë‹¤.
2. **ì•ˆì „ ë²”ìœ„ ê°’ ì €ìž¥**: ì‚¬ìš©ìžê°€ ê¸°ê¸° ë“±ë¡ ì‹œ ìž…ë ¥í•œ ì•ˆì „ ë²”ìœ„ ê°’ì„ SPIFFS íŒŒì¼ì— ê¸°ë¡í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ íŒŒì¼ì€ JSON í˜•ì‹ìœ¼ë¡œ ì €ìž¥ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
3. **ì„¼ì„œ ë°ì´í„°ì™€ ë¹„êµ**: ì£¼ê¸°ì ìœ¼ë¡œ ì„¼ì„œì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³ , SPIFFSì— ì €ìž¥ëœ ê°’ê³¼ ë¹„êµí•©ë‹ˆë‹¤.
4. **ì´ìƒ ì•Œë¦¼ ì „ì†¡**: ì„¼ì„œ ë°ì´í„°ê°€ ì €ìž¥ëœ ì•ˆì „ ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ê²½ìš°, ì´ë¥¼ ê°ì§€í•˜ì—¬ MQTTë¥¼ í†µí•´ ë°±ì—”ë“œ ì„œë²„ë¡œ ì•Œë¦¼ì„ ì „ì†¡í•©ë‹ˆë‹¤.


## íŠ¸ëŸ¬ë¸” ìŠˆíŒ… (Troubleshooting)

### 1. ì‹œê°„ ì§€ì—° ë¬¸ì œ í•´ê²°
ê¸°ê¸°ë¥¼ ìž‘ë™ì‹œí‚¤ëŠ” ë™ì•ˆ ì‹œê°„ì´ ë°€ë¦¬ëŠ” í˜„ìƒì´ ë°œìƒí•˜ì—¬, ì •í™•í•œ íƒ€ì´ë° ì œì–´ê°€ ì–´ë ¤ìš´ ìƒí™©ì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **`millis()`** ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ í˜„ìž¬ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ê¸°ê¸°ê°€ ë™ìž‘í•  ìˆ˜ ìžˆë„ë¡ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

- **ë¬¸ì œ ì›ì¸**: íƒ€ì´ë¨¸ë‚˜ ë”œë ˆì´ê°€ ê±¸ë¦° ìƒíƒœì—ì„œ ë‹¤ë¥¸ ìž‘ì—…ì„ ë³‘í–‰í•˜ëŠ” ê²½ìš°, ì‹œê°„ì´ ë°€ë¦¬ê±°ë‚˜ ì •í™•í•œ íƒ€ì´ë°ì„ ìœ ì§€í•˜ê¸° ì–´ë ¤ìš´ ìƒí™©ì´ ë°œìƒí•¨.
- **í•´ê²° ë°©ë²•**: `millis()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ê¸°ê°€ í˜„ìž¬ ì‹œê°„ì„ ê³„ì† ì¸ì‹í•˜ê²Œ í•˜ê³ , ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìž‘ì—…ì„ ì¼ì • ê°„ê²©ìœ¼ë¡œ ìˆ˜í–‰í•˜ë„ë¡ ê°œì„ í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì‹œê°„ì´ ë°€ë¦¬ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ , ë™ì‹œ ìž‘ì—…ì„ íš¨ê³¼ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìžˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

### `millis()` í•¨ìˆ˜ ì ìš© ì˜ˆì‹œ ì½”ë“œ:
```cpp
unsigned long previousMillis = 0;
const long interval = 1000;  // 1ì´ˆ ê°„ê²©

void loop() {
  unsigned long currentMillis = millis();
  
  if (currentMillis - previousMillis >= interval) {
    // 1ì´ˆë§ˆë‹¤ ì‹¤í–‰í•  ìž‘ì—…
    previousMillis = currentMillis;
    Serial.println("1ì´ˆë§ˆë‹¤ ì‹¤í–‰");
  }
}




